=============================================================================
  FLUJO OPTIMIZADO: IF + BASIC LLM PARA DIVISIÃ“N DE MENSAJES
=============================================================================

CASO 1: MENSAJE CORTO (â‰¤130 caracteres)
---------------------------------------

    Agente (Learn)
         |
         | output: "Hola Â¿cÃ³mo estÃ¡s?"
         | length: 19 caracteres
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ IF: Message Length Check   â”‚
    â”‚ Â¿length > 130?             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         |
         | FALSE (19 â‰¤ 130) âœ“
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Send WhatsApp (Short)      â”‚
    â”‚ EnvÃ­o directo sin procesar â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         |
         | âš¡ Inmediato
         | ðŸ’° Sin costo LLM
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Call Actualizar_memoria    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


=============================================================================

CASO 2: MENSAJE LARGO (>130 caracteres)
---------------------------------------

    Agente (Learn)
         |
         | output: "El Business Model Canvas es una herramienta
         |          estratÃ©gica que permite visualizar modelos
         |          de negocio. Se compone de 9 bloques..."
         | length: 180 caracteres
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ IF: Message Length Check   â”‚
    â”‚ Â¿length > 130?             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         |
         | TRUE (180 > 130) âœ“
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Basic LLM Chain            â”‚
    â”‚ "Split in 2 Parts"         â”‚
    â”‚                            â”‚
    â”‚ Prompt: "Divide en 2       â”‚
    â”‚ partes de max 130 chars"   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         |
         | ðŸ¤– Procesamiento LLM (~1-2s)
         | ðŸ’° Costo: ~$0.00001
         â†“
    Output LLM:
    ["El Business Model Canvas es una herramienta estratÃ©gica
      que permite visualizar modelos de negocio.",
     "Se compone de 9 bloques fundamentales que cubren
      las Ã¡reas clave."]
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Code: Parse JSON           â”‚
    â”‚ Convierte string a array   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         |
         | messageParts = [part1, part2]
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Split Out                  â”‚
    â”‚ Convierte array â†’ items    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         |
         | Item 1: part1
         | Item 2: part2
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Loop Over Items            â”‚
    â”‚ (Procesa secuencialmente)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         |
         â”œâ”€â”€â”€ IteraciÃ³n 1 (part1) â”€â”€â”€â”€â”
         |                            |
         â†“                            |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   |
    â”‚ Code: Add Index            â”‚   |
    â”‚ is_first_message = true    â”‚   |
    â”‚ part_number = 1            â”‚   |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   |
         |                            |
         â†“                            |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   |
    â”‚ IF: Is First Message?      â”‚   |
    â”‚ Â¿is_first_message = true?  â”‚   |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   |
         |                            |
         | TRUE âœ“                     |
         â†“                            |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   |
    â”‚ Send WhatsApp (Long)       â”‚   |
    â”‚ EnvÃ­a parte 1              â”‚   |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   |
         |                            |
         | âœ… Mensaje 1 enviado       |
         | "El Business Model..."    |
         |                            |
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                      |
         â”œâ”€â”€â”€ IteraciÃ³n 2 (part2) â”€â”€â”€â”€â”¤
         |                            |
         â†“                            |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   |
    â”‚ Code: Add Index            â”‚   |
    â”‚ is_first_message = false   â”‚   |
    â”‚ part_number = 2            â”‚   |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   |
         |                            |
         â†“                            |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   |
    â”‚ IF: Is First Message?      â”‚   |
    â”‚ Â¿is_first_message = true?  â”‚   |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   |
         |                            |
         | FALSE âœ—                    |
         â†“                            |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   |
    â”‚ Wait 5 Seconds             â”‚   |
    â”‚ â±ï¸  Delay antes de enviar   â”‚   |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   |
         |                            |
         | â³ Esperando 5s...         |
         â†“                            |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   |
    â”‚ Send WhatsApp (Long)       â”‚   |
    â”‚ EnvÃ­a parte 2              â”‚   |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   |
         |                            |
         | âœ… Mensaje 2 enviado       |
         | "Se compone de 9..."       |
         |                            |
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
              Loop completo
                      â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Call Actualizar_memoria    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


=============================================================================

RESUMEN DE CAMINOS
-----------------

Mensaje â‰¤130 chars:  Agente â†’ IF â†’ Send (Short) â†’ Actualizar
                     Nodos: 3
                     Tiempo: ~1s
                     Costo: $0

Mensaje >130 chars:  Agente â†’ IF â†’ LLM â†’ Parse â†’ Split â†’ Loop â†’
                     Add Index â†’ IF â†’ [Wait â†’] Send (Long) â†’ Actualizar
                     Nodos: 10 (8 si es primera parte)
                     Tiempo: ~7-8s (con delay)
                     Costo: ~$0.00001


=============================================================================

VENTAJAS DEL FLUJO OPTIMIZADO
-----------------------------

âœ… Eficiente:     Solo usa LLM cuando es necesario
âœ… RÃ¡pido:        Mensajes cortos son instantÃ¡neos
âœ… EconÃ³mico:     Ahorra ~70% vs siempre usar LLM
âœ… Inteligente:   DivisiÃ³n semÃ¡ntica de calidad
âœ… Profesional:   UX mejorada con delays apropiados


=============================================================================

ESTADÃSTICAS ESPERADAS (ejemplo: 1000 mensajes/mes)
---------------------------------------------------

Asumiendo 70% mensajes cortos, 30% largos:

  Mensajes cortos (â‰¤130):  700  â†’  $0.000  (sin LLM)
  Mensajes largos (>130):  300  â†’  $0.003  (con LLM)
                          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Total mensajes:         1000  â†’  $0.003/mes

  Ahorro vs "siempre LLM":  70%
  Tiempo ahorrado:          ~700s (700 Ã— 1s de LLM)


=============================================================================
